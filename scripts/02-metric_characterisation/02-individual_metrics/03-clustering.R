library(dynbenchmark)
library(tidyverse)
library(patchwork)

experiment("02-metric_characterisation/02-individual_metrics")

set.seed(9)
dataset <- dyntoy::generate_dataset(model = dyntoy::model_binary_tree(num_branchpoints = 2)) %>% simplify_trajectory()

plot_clustering_scores_overview <- wrap_plots(
  plot_graph(dataset, label_milestones = TRUE) + ggtitle("Reference"),
  plot_graph(dataset, grouping = group_onto_nearest_milestones(dataset), plot_milestones = TRUE) + ggtitle("Cells mapped to milestones"),
  plot_graph(dataset, grouping = group_onto_trajectory_edges(dataset)) + ggtitle("Cells mapped to branches")
)

plot_clustering_scores_overview

write_rds(plot_clustering_scores_overview, result_file("clustering_scores_overview.rds"))
