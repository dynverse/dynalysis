---
title: "An evaluation framework for trajectory inference methods"
author:
  - Robrecht Cannoodt* ¹ ² ³
  - Wouter Saelens* ¹ ²
  - Helena Todorov¹ ²
  - Yvan Saeys¹ ²
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
    bookdown::html_document2:
    fig_caption: yes
    reference_docx: templates/template.docx
bibliography: references.bib
csl: nature-biotechnology.csl
abstract: |
  Using single-cell transcriptomics data, it is now possible to computationally order cells along trajectories, allowing the unbiased transcriptome-wide study of cellular dynamic processes. Dozens of trajectory inference methods have been developed, early methods mostly focussing on linear trajectories, while recently methods also model more complex branching trajectories. However, the performance of these methods have not yet been comprehensively evaluated. Here, we compare a total of 22 trajectory inference methods, on both realistic synthetic datasets and a large set is real datasets. We employ a novel parameter optimisation procedure, and compare methods using several metrics, including accuracy of the inferred ordering, correctness of the network wiring, code quality and user friendliness. We conclude with practical guidelines for method users, and also believe our evaluation framework can be used to spearhead the development for new methods. Our evaluation pipeline is fully reproducible, can be easily extended and is available at www.github.com/dynverse.
keywords: |
  trajectory inference; pseudotemporal ordering; single-cell transcriptomics
highlights: |
  These are the highlights. 
---
\* Equal contribution  
¹ Data mining and modelling for biomedicine, VIB Center for Inflammation Research, Ghent, Belgium  
² Department of ???, Ghent University, Ghent, Belgium  
³ Center for Medical Genetics, Ghent University  

```{r setup, include=FALSE}
knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file())
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  comment = "#>",
  fig.path = "analysis/figures/"
)

library(dynalysis)
library(tidyverse)
library(cowplot)

# refering to figures & supplementary figures
refs <- tibble(ref_id = character(), name = character(), ref_type = character())
ref <- function(ref_type, ref_id, suffix="", anchor=FALSE) {
  if(nrow(refs %>% filter(ref_id == !!ref_id)) == 0) {
    refs <<- refs %>% bind_rows(tibble(
      name = create_names[[ref_type]](sum(refs$ref_type == ref_type) + 1),
      ref_type = ref_type,
      ref_id = ref_id
    ))
  }
  ref <- refs %>% filter(ref_id == !!ref_id) %>% 
    pull(name) %>% 
    {pritt("[**{.}{suffix}**](#{ref_type}_{ref_id})")}
  
  if (anchor) ref <- pritt("{ref}<a name='{ref_type}_{ref_id}'></a>")
  ref
}
create_names <- list(
  sfig = function(i) {pritt("Supplementary Figure {i}")},
  fig = function(i) {pritt("Figure {i}")}
)
```
